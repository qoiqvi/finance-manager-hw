# Менеджер личных финансов

Комплексное серверное приложение для управления личными финансами с поддержкой нескольких пользователей, отслеживанием бюджета и переводами между кошельками.

![Java](https://img.shields.io/badge/Java-21-orange)
![Maven](https://img.shields.io/badge/Maven-3.8+-blue)
![License](https://img.shields.io/badge/License-MIT-green)

## Возможности

### Базовые функции (30 баллов)
✅ **Многопользовательская аутентификация** - Безопасная регистрация и вход с хешированием паролей
✅ **Управление транзакциями** - Добавление доходов и расходов с категориями
✅ **Управление бюджетом** - Установка и отслеживание бюджетов по категориям расходов
✅ **Постоянное хранение** - Сохранение кошельков пользователей в JSON-файлы
✅ **Финансовая статистика** - Просмотр общих доходов, расходов и разбивки по категориям
✅ **Умные уведомления** - Оповещения о превышении бюджета и отрицательном балансе
✅ **Валидация ввода** - Комплексная проверка с понятными сообщениями об ошибках
✅ **CLI-интерфейс** - Интерактивный интерфейс командной строки с непрерывным циклом

### Средние функции (10 баллов)
✅ **Расширенная фильтрация** - Статистика по конкретным категориям или периодам
✅ **Редактирование бюджета** - Изменение или удаление существующих бюджетов
✅ **Экспорт/Импорт** - Экспорт транзакций в CSV, сохранение снимков кошелька
✅ **Улучшенные уведомления** - Предупреждения при использовании 80% бюджета
✅ **Улучшенный CLI UX** - Команда помощи, форматированные таблицы, понятная обратная связь

### Продвинутые функции (10 баллов)
✅ **Комплексное тестирование** - 15+ модульных и интеграционных тестов с покрытием 50%+
✅ **Чистая архитектура** - Разделение слоёв core/infrastructure/CLI
✅ **Качество кода** - Конфигурация Checkstyle и Spotless
✅ **CI/CD Pipeline** - GitHub Actions для автоматического тестирования и валидации
✅ **Полная документация** - JavaDoc, README, обзор архитектуры

### Бонусные функции
✅ **Переводы между кошельками** - Отправка денег между аккаунтами пользователей

## Архитектура

Приложение следует принципам чистой архитектуры с чётким разделением слоёв:

```
┌─────────────────────────────────────────────┐
│          Слой CLI (Представление)           │
│   FinanceApp, CommandHandler, Validators    │
└─────────────────┬───────────────────────────┘
                  │
┌─────────────────┴───────────────────────────┐
│          Слой Core (Бизнес-логика)          │
│   Services, Models, Domain Logic            │
└─────────────────┬───────────────────────────┘
                  │
┌─────────────────┴───────────────────────────┐
│      Слой Infrastructure (Хранение)         │
│   Repositories, JSON Storage Manager        │
└─────────────────────────────────────────────┘
```

### Структура проекта
```
finance-manager/
├── src/
│   ├── main/java/com/finance/
│   │   ├── Main.java                    # Точка входа приложения
│   │   ├── core/                        # Доменный слой
│   │   │   ├── model/                   # Доменные сущности
│   │   │   │   ├── User.java
│   │   │   │   ├── Wallet.java
│   │   │   │   ├── Transaction.java
│   │   │   │   ├── Category.java
│   │   │   │   ├── Budget.java
│   │   │   │   └── TransactionType.java
│   │   │   └── service/                 # Бизнес-логика
│   │   │       ├── AuthService.java
│   │   │       ├── TransactionService.java
│   │   │       ├── BudgetService.java
│   │   │       ├── StatisticsService.java
│   │   │       ├── NotificationService.java
│   │   │       └── TransferService.java
│   │   ├── infrastructure/              # Слой хранения
│   │   │   ├── repository/
│   │   │   │   ├── UserRepository.java
│   │   │   │   ├── WalletRepository.java
│   │   │   │   ├── InMemoryUserRepository.java
│   │   │   │   └── JsonWalletRepository.java
│   │   │   └── storage/
│   │   │       └── JsonStorageManager.java
│   │   ├── cli/                         # Слой CLI
│   │   │   ├── FinanceApp.java
│   │   │   ├── CommandHandler.java
│   │   │   ├── InputValidator.java
│   │   │   └── OutputFormatter.java
│   │   └── exception/                   # Пользовательские исключения
│   └── test/                            # Тесты
├── data/                                # Хранилище кошельков
├── pom.xml                              # Конфигурация Maven
└── README.md
```

## Установка

### Требования
- Java 21 или выше
- Maven 3.8 или выше
- Git

### Клонирование и сборка
```bash
git clone <url-вашего-репозитория>
cd finance-manager

# Сборка проекта
mvn clean package

# Запуск тестов
mvn test

# Проверка стиля кода
mvn checkstyle:check

# Генерация отчёта о покрытии
mvn jacoco:report
```

## Использование

### Запуск приложения

```bash
# С помощью Maven
mvn exec:java -Dexec.mainClass="com.finance.Main"

# Или запуск скомпилированного JAR
java -jar target/finance-manager-1.0.0-fat.jar
```

### Доступные команды

#### Аутентификация
```bash
register <имя_пользователя> <пароль>       # Создать новый аккаунт
login <имя_пользователя> <пароль>          # Войти в аккаунт
logout                                      # Выйти и сохранить кошелёк
```

#### Управление транзакциями
```bash
add-income <сумма> <категория> [описание]
# Пример: add-income 50000 Salary Ежемесячная зарплата

add-expense <сумма> <категория> [описание]
# Пример: add-expense 500 Food Продукты в супермаркете
```

#### Управление бюджетом
```bash
set-budget <категория> <лимит>        # Установить лимит бюджета
# Пример: set-budget Food 5000

edit-budget <категория> <новый_лимит>  # Обновить существующий бюджет
# Пример: edit-budget Food 6000

delete-budget <категория>              # Удалить бюджет
show-budget                            # Показать все бюджеты
```

#### Статистика и отчёты
```bash
show-stats                           # Полный финансовый обзор

stats-by-category <кат1> <кат2> ...  # Статистика по конкретным категориям
# Пример: stats-by-category Food Transport

stats-by-period <начало> <конец>     # Статистика за период
# Пример: stats-by-period 2024-01-01 2024-01-31
```

#### Переводы
```bash
transfer <получатель> <сумма> [описание]
# Пример: transfer alice 1000 Оплата обеда
```

#### Экспорт
```bash
export-csv <путь_к_файлу>                # Экспорт транзакций в CSV
# Пример: export-csv transactions.csv

export-json <путь_к_файлу>               # Сохранить снимок кошелька
# Пример: export-json backup.json
```

#### Прочее
```bash
help                                 # Показать список команд
exit                                 # Выйти из приложения
```

## Примеры использования

### Пример сессии

```
> register john password123
✓ Пользователь успешно зарегистрирован: john

> login john password123
✓ Вход выполнен успешно. Добро пожаловать, john!
Текущий баланс: 0.0

> add-income 20000 Salary Зарплата за январь
✓ Доход добавлен: 20,000.0 в Salary
Новый баланс: 20,000.0

> add-income 40000 Salary Зарплата за февраль
✓ Доход добавлен: 40,000.0 в Salary
Новый баланс: 60,000.0

> add-income 3000 Bonus Премия за результаты
✓ Доход добавлен: 3,000.0 в Bonus
Новый баланс: 63,000.0

> set-budget Food 4000
✓ Бюджет установлен для Food: 4,000.0

> set-budget Entertainment 3000
✓ Бюджет установлен для Entertainment: 3,000.0

> set-budget Utilities 2500
✓ Бюджет установлен для Utilities: 2,500.0

> add-expense 300 Food Продукты
✓ Расход добавлен: 300.0 из Food
Новый баланс: 62,700.0

> add-expense 500 Food Ресторан
✓ Расход добавлен: 500.0 из Food
Новый баланс: 62,200.0

> add-expense 3000 Entertainment Билеты на концерт
✓ Расход добавлен: 3,000.0 из Entertainment
Новый баланс: 59,200.0
⚠️  БЮДЖЕТ ПРЕВЫШЕН: Категория 'Entertainment' - Потрачено: 3000.00, Лимит: 3000.00, Превышение: 0.00

> add-expense 3000 Utilities Ежемесячные счета
✓ Расход добавлен: 3,000.0 из Utilities
Новый баланс: 56,200.0
⚠️  БЮДЖЕТ ПРЕВЫШЕН: Категория 'Utilities' - Потрачено: 3000.00, Лимит: 2500.00, Превышение: 500.00

> add-expense 1500 Transport Такси
✓ Расход добавлен: 1,500.0 из Transport
Новый баланс: 54,700.0

> show-stats

═══════════════════════════════════════════════════════════════════════════════
                         ФИНАНСОВАЯ СТАТИСТИКА
═══════════════════════════════════════════════════════════════════════════════

Общий доход:      63,000.0
Общие расходы:    8,300.0
Чистый баланс:    54,700.0

Доходы по категориям:
──────────────────────────────────────────────────
Salary                        : 60,000.0
Bonus                         : 3,000.0

Сводка по бюджету:
────────────────────────────────────────────────────────────────────────────────
Категория                         Лимит           Потрачено   Остаток       Исп.
────────────────────────────────────────────────────────────────────────────────
Utilities                       2,500.0         3,000.0        -500.0     120.0%
Food                            4,000.0           800.0         3,200.0     20.0%
Entertainment                   3,000.0         3,000.0             0.0    100.0%
```

## Тестирование

### Запуск тестов
```bash
# Запуск всех тестов
mvn test

# Запуск конкретного тестового класса
mvn test -Dtest=AuthServiceTest

# Генерация отчёта о покрытии
mvn jacoco:report

# Просмотр отчёта о покрытии
open target/site/jacoco/index.html
```

### Покрытие тестами
Проект включает 15+ комплексных тестов, охватывающих:
- ✅ Сервис аутентификации (7 тестов)
- ✅ Сервис транзакций (6 тестов)
- ✅ Сервис бюджета (9 тестов)
- ✅ Сервис статистики (10 тестов)
- ✅ Сервис переводов (6 тестов)
- ✅ Валидация ввода (10 тестов)
- ✅ Интеграция JSON-репозитория (5 тестов)

**Целевое покрытие: 50%+** (фактическое покрытие превышает это значение)

## Качество кода

### Checkstyle
```bash
mvn checkstyle:check
```

### Форматирование кода (Spotless)
```bash
# Проверка форматирования
mvn spotless:check

# Автоматическое форматирование
mvn spotless:apply
```

## CI/CD

GitHub Actions pipeline автоматически:
1. ✅ Собирает проект
2. ✅ Запускает все тесты
3. ✅ Проверяет стиль кода
4. ✅ Проверяет форматирование
5. ✅ Генерирует отчёт о покрытии
6. ✅ Упаковывает приложение

## Хранение данных

Кошельки пользователей автоматически сохраняются в директорию `data/`:
- Формат: `data/{имя_пользователя}_wallet.json`
- Автосохранение при выходе
- Автозагрузка при входе

### Пример JSON кошелька
```json
{
  "userId": "john",
  "balance": 54700.0,
  "transactions": [
    {
      "id": "uuid-здесь",
      "amount": 20000.0,
      "category": "Salary",
      "type": "INCOME",
      "date": "2024-01-15T10:30:00",
      "description": "Зарплата за январь"
    }
  ],
  "budgets": [
    {
      "category": "Food",
      "categoryType": "EXPENSE",
      "limit": 4000.0,
      "spent": 800.0
    }
  ]
}
```

## Автор

Разработано как комплексное серверное Java-приложение, демонстрирующее:
- Принципы чистой архитектуры
- TDD (Разработка через тестирование)
- Лучшие практики CI/CD
- Профессиональные стандарты качества кода
